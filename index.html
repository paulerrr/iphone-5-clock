<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Clock">
    <meta name="format-detection" content="telephone=no">
    <title>Responsive Clock</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #000;
            color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }
        
        .container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }
        
        .clock-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            transition: all 0.3s ease;
        }
        
        .time {
            font-size: clamp(3rem, 15vw, 6rem);
            font-weight: 200;
            margin-bottom: 10px;
            text-align: center;
            transition: font-size 0.3s ease;
        }
        
        .date {
            font-size: clamp(1rem, 5vw, 1.8rem);
            font-weight: 300;
            margin-bottom: 20px;
            text-align: center;
            transition: font-size 0.3s ease;
        }
        
        .seconds {
            font-size: clamp(1.5rem, 8vw, 3rem);
            font-weight: 200;
            margin-top: 10px;
            transition: font-size 0.3s ease;
        }
        
        .ui-controls {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none; /* Allow clicks to pass through */
        }
        
        .ui-controls > * {
            pointer-events: auto; /* Re-enable clicks for children */
        }
        
        .settings {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: clamp(1.2rem, 5vw, 1.8rem);
            cursor: pointer;
            z-index: 5;
            transition: all 0.3s ease;
        }
        
        .settings-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            z-index: 10;
        }
        
        .settings-panel.active {
            display: flex;
        }
        
        .settings-panel-content {
            width: 90%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .settings-option {
            margin: 5px 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .settings-option label {
            font-size: clamp(1rem, 4vw, 1.2rem);
        }
        
        .close-settings {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: clamp(1.2rem, 5vw, 1.8rem);
            cursor: pointer;
            z-index: 15;
        }
        
        .color-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }
        
        .color-option {
            width: clamp(30px, 8vw, 40px);
            height: clamp(30px, 8vw, 40px);
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: transform 0.2s ease;
        }
        
        .color-option:hover {
            transform: scale(1.1);
        }
        
        .color-option.active {
            border-color: white;
        }
        
        /* Fullscreen button */
        .fullscreen-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: clamp(1.2rem, 5vw, 1.8rem);
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            opacity: 0.5;
            transition: opacity 0.3s ease;
            z-index: 5;
        }
        
        .fullscreen-btn:hover {
            opacity: 1;
        }
        
        /* Night mode */
        .night-mode {
            background-color: #000;
            color: #c00;
        }
        
        /* Battery indicator */
        .battery-indicator {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: clamp(0.8rem, 3vw, 1rem);
            display: flex;
            align-items: center;
            z-index: 5;
            transition: all 0.3s ease;
        }
        
        .battery-level {
            width: clamp(20px, 6vw, 30px);
            height: clamp(10px, 3vw, 15px);
            border: 1px solid currentColor;
            margin-left: 5px;
            position: relative;
        }
        
        .battery-level:after {
            content: '';
            position: absolute;
            top: 1px;
            left: 1px;
            height: calc(100% - 2px);
            background-color: currentColor;
            transition: width 0.5s ease;
        }
        
        /* Landscape orientation adjustments */
        @media screen and (orientation: landscape) {
            .clock-container {
                flex-direction: row;
                justify-content: space-evenly;
                align-items: center;
                gap: 20px;
            }
            
            .date-time-container {
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }
            
            .time {
                font-size: clamp(2.5rem, 12vw, 4rem);
                margin-bottom: 5px;
            }
            
            .date {
                font-size: clamp(0.9rem, 3vw, 1.2rem);
                margin-bottom: 5px;
            }
            
            .seconds {
                font-size: clamp(1.2rem, 8vh, 2.5rem);
                margin-top: 0;
            }
            
            .battery-indicator {
                top: 10px;
                left: 10px;
            }
            
            .settings {
                top: 10px;
                right: 10px;
            }
            
            .fullscreen-btn {
                bottom: 10px;
                right: 10px;
            }
            
            .settings-panel-content {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
                max-width: 90%;
                gap: 20px;
            }
            
            .settings-option {
                width: auto;
                min-width: 150px;
            }
        }
        
        /* Small screen adjustments */
        @media screen and (max-height: 400px) and (orientation: landscape) {
            .time {
                font-size: clamp(2rem, 10vh, 3rem);
            }
            
            .date {
                font-size: clamp(0.8rem, 2vh, 1rem);
            }
            
            .seconds {
                font-size: clamp(1rem, 8vh, 2rem);
            }
        }
        
        /* Animation for orientation change */
        @media (prefers-reduced-motion: no-preference) {
            .clock-container,
            .battery-indicator,
            .settings,
            .fullscreen-btn {
                transition: all 0.5s ease;
            }
        }
        
        /* Add iOS standalone mode improvements */
        .standalone .container {
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
        }
        
        /* Tap highlight adjustment */
        * {
            -webkit-tap-highlight-color: rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="ui-controls">
            <div class="battery-indicator">
                <span id="battery-percentage">--</span>
                <div class="battery-level" id="battery-level"></div>
            </div>
            
            <div class="settings">⚙️</div>
            <button class="fullscreen-btn" id="fullscreen-btn">⤢</button>
        </div>
        
        <div class="clock-container">
            <div class="date-time-container">
                <div class="date" id="date">Monday, January 1</div>
                <div class="time" id="time">12:00</div>
            </div>
            <div class="seconds" id="seconds">00</div>
        </div>
    </div>
    
    <div class="settings-panel">
        <div class="close-settings">✕</div>
        
        <div class="settings-panel-content">
            <div class="settings-option">
                <label>24-Hour Format</label>
                <input type="checkbox" id="format-toggle">
            </div>
            
            <div class="settings-option">
                <label>Show Seconds</label>
                <input type="checkbox" id="seconds-toggle" checked>
            </div>
            
            <div class="settings-option">
                <label>Night Mode</label>
                <input type="checkbox" id="night-mode-toggle">
            </div>
            
            <div class="settings-option" style="width: 100%;">
                <label>Color Theme</label>
            </div>
            
            <div class="color-options">
                <div class="color-option active" style="background-color: #fff;" data-color="#fff"></div>
                <div class="color-option" style="background-color: #ff5252;" data-color="#ff5252"></div>
                <div class="color-option" style="background-color: #4caf50;" data-color="#4caf50"></div>
                <div class="color-option" style="background-color: #2196f3;" data-color="#2196f3"></div>
                <div class="color-option" style="background-color: #ff9800;" data-color="#ff9800"></div>
                <div class="color-option" style="background-color: #9c27b0;" data-color="#9c27b0"></div>
            </div>
        </div>
    </div>
    
    <script>
        // DOM Elements
        const timeElement = document.getElementById('time');
        const dateElement = document.getElementById('date');
        const secondsElement = document.getElementById('seconds');
        const settingsBtn = document.querySelector('.settings');
        const closeSettingsBtn = document.querySelector('.close-settings');
        const settingsPanel = document.querySelector('.settings-panel');
        const formatToggle = document.getElementById('format-toggle');
        const secondsToggle = document.getElementById('seconds-toggle');
        const nightModeToggle = document.getElementById('night-mode-toggle');
        const colorOptions = document.querySelectorAll('.color-option');
        const fullscreenBtn = document.getElementById('fullscreen-btn');
        const batteryPercentage = document.getElementById('battery-percentage');
        const batteryLevel = document.getElementById('battery-level');
        
        // Clock Settings
        let settings = {
            is24Hour: false,
            showSeconds: true,
            nightMode: false,
            color: '#fff'
        };
        
        // Load settings from localStorage if available
        if (localStorage.getItem('clockSettings')) {
            settings = JSON.parse(localStorage.getItem('clockSettings'));
            applySettings();
        }
        
        // Detect and handle orientation changes
        function handleOrientationChange() {
            const isLandscape = window.innerWidth > window.innerHeight;
            document.body.classList.toggle('landscape', isLandscape);
            document.body.classList.toggle('portrait', !isLandscape);
        }
        
        // Call initially and on resize
        handleOrientationChange();
        window.addEventListener('resize', handleOrientationChange);
        
        // Update clock
        function updateClock() {
            const now = new Date();
            
            // Format time
            let hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            
            if (!settings.is24Hour) {
                hours = hours % 12;
                hours = hours ? hours : 12; // Convert 0 to 12 for 12-hour format
            }
            
            const timeString = `${hours}:${minutes}`;
            timeElement.textContent = timeString;
            secondsElement.textContent = seconds;
            
            // Format date
            const options = { weekday: 'long', month: 'long', day: 'numeric' };
            const dateString = now.toLocaleDateString(undefined, options);
            dateElement.textContent = dateString;
        }
        
        // Apply settings
        function applySettings() {
            // Apply 24-hour format
            formatToggle.checked = settings.is24Hour;
            
            // Apply seconds visibility
            secondsToggle.checked = settings.showSeconds;
            secondsElement.style.display = settings.showSeconds ? 'block' : 'none';
            
            // Apply night mode
            nightModeToggle.checked = settings.nightMode;
            document.body.classList.toggle('night-mode', settings.nightMode);
            
            // Apply color theme
            document.documentElement.style.setProperty('--text-color', settings.color);
            document.body.style.color = settings.color;
            
            colorOptions.forEach(option => {
                if (option.dataset.color === settings.color) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
            
            // Save settings to localStorage
            localStorage.setItem('clockSettings', JSON.stringify(settings));
        }
        
        // Event Listeners
        settingsBtn.addEventListener('click', () => {
            settingsPanel.classList.add('active');
        });
        
        closeSettingsBtn.addEventListener('click', () => {
            settingsPanel.classList.remove('active');
        });
        
        formatToggle.addEventListener('change', () => {
            settings.is24Hour = formatToggle.checked;
            applySettings();
            updateClock();
        });
        
        secondsToggle.addEventListener('change', () => {
            settings.showSeconds = secondsToggle.checked;
            applySettings();
        });
        
        nightModeToggle.addEventListener('change', () => {
            settings.nightMode = nightModeToggle.checked;
            applySettings();
        });
        
        colorOptions.forEach(option => {
            option.addEventListener('click', () => {
                settings.color = option.dataset.color;
                applySettings();
            });
        });
        
        // Fullscreen functionality
        fullscreenBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                document.exitFullscreen();
            }
        });
        
        // Battery API (if available)
        if ('getBattery' in navigator) {
            navigator.getBattery().then(battery => {
                // Update battery display
                function updateBattery() {
                    const level = Math.floor(battery.level * 100);
                    batteryPercentage.textContent = `${level}%`;
                    batteryLevel.querySelector(':after').style.width = `${(batteryLevel.offsetWidth - 2) * battery.level}px`;
                }
                
                // Initial battery update
                updateBattery();
                
                // Battery event listeners
                battery.addEventListener('levelchange', updateBattery);
            });
        } else {
            // Hide battery indicator if API not available
            document.querySelector('.battery-indicator').style.display = 'none';
        }
        
        // Keep screen awake - simplified approach combining Wake Lock API and fallback
        
        // 1. Wake Lock API (modern browsers)
        let wakeLock = null;
        
        const requestWakeLock = async () => {
            if ('wakeLock' in navigator) {
                try {
                    wakeLock = await navigator.wakeLock.request('screen');
                    console.log('Wake Lock activated');
                } catch (err) {
                    console.log(`Wake Lock error: ${err.message}`);
                    // Fall back to video method if Wake Lock fails
                    enableVideoWakeLock();
                }
            } else {
                // Fall back to video method if Wake Lock not supported
                enableVideoWakeLock();
            }
        };
        
        // 2. Video fallback method
        function enableVideoWakeLock() {
            // Create a video element with minimal black video
            const video = document.createElement('video');
            video.setAttribute('loop', '');
            video.setAttribute('playsinline', '');
            video.setAttribute('muted', true);
            video.setAttribute('width', '1');
            video.setAttribute('height', '1');
            video.style.position = 'absolute';
            video.style.top = '0';
            video.style.left = '0';
            video.style.width = '1px';
            video.style.height = '1px';
            video.style.opacity = '0.01';
            
            // Create a minimal black video (this is a data URI for a minimal MP4)
            const videoSource = document.createElement('source');
            videoSource.setAttribute('src', 'data:video/mp4;base64,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');
            videoSource.setAttribute('type', 'video/mp4');
            video.appendChild(videoSource);
            
            document.body.appendChild(video);
            
            // Try to play video
            const playVideo = () => {
                video.play().catch(e => console.log('Video play prevented:', e));
            };
            
            // Play on interaction and periodically
            document.addEventListener('click', playVideo, { once: true });
            document.addEventListener('touchstart', playVideo, { once: true });
            
            // Also try to play the video initially
            playVideo();
            
            // Re-attempt periodically
            setInterval(playVideo, 30000);
        }
        
        // Request wake lock when page loads and when document becomes visible
        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'visible' && (!wakeLock || wakeLock.released)) {
                requestWakeLock();
            }
        });
        
        // Initial wake lock request
        requestWakeLock();
        
        // Initialize clock
        updateClock();
        setInterval(updateClock, 1000);
        
        // Add iOS web app support
        if (window.navigator.standalone) {
            document.body.classList.add('standalone');
        }
        
        // Double tap to enter/exit fullscreen
        let lastTap = 0;
        document.addEventListener('touchend', (e) => {
            const currentTime = new Date().getTime();
            const tapLength = currentTime - lastTap;
            
            if (tapLength < 500 && tapLength > 0) {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(err => {
                        console.log(`Error attempting to enable fullscreen: ${err.message}`);
                    });
                } else {
                    document.exitFullscreen();
                }
                e.preventDefault();
            }
            
            lastTap = currentTime;
        });
        
        // Fix for battery indicator
        if ('getBattery' in navigator) {
            navigator.getBattery().then(battery => {
                // Fix the battery level indicator properly
                function updateBatteryLevel() {
                    const level = Math.floor(battery.level * 100);
                    batteryPercentage.textContent = `${level}%`;
                    
                    // Update the width of the :after pseudo-element
                    // Since we can't directly modify pseudo-elements with JS,
                    // we use inline style width as a percentage
                    const batteryFill = document.getElementById('battery-level');
                    batteryFill.style.setProperty('--battery-width', `${level}%`);
                    
                    // Fallback approach - update via CSS variable
                    document.documentElement.style.setProperty('--battery-level', `${level}%`);
                }
                
                updateBatteryLevel();
                battery.addEventListener('levelchange', updateBatteryLevel);
            });
        }
        
        // Handle settings panel on orientation change
        window.addEventListener('orientationchange', () => {
            // Close settings panel on orientation change for better UX
            if (settingsPanel.classList.contains('active')) {
                setTimeout(() => {
                    settingsPanel.classList.remove('active');
                }, 300);
            }
        });
    </script>
</body>
</html>